<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.test1.mapper.PointMapper">
	<select id="selectPointList" parameterType="hashmap" resultType="com.example.test1.model.Point">
		SELECT C.USERID,NAME,ADDRESS,GENDER,APOINT,CDATE
		FROM TBL_CUSTOMER C
		INNER JOIN TBL_POINT P ON C.USERID=P.USERID
		INNER JOIN(
		    SELECT USERID,TO_CHAR(MAX(CDATETIME),'YYYY-MM-DD') AS CDATE
		    FROM TBL_POINT
		    GROUP BY USERID
		)T ON P.USERID=T.USERID AND P.CDATETIME=T.CDATE
	</select>
	
	
</mapper>




