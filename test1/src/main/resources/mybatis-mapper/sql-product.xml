<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.test1.mapper.ProductMapper">
	
	<select id="selectFoodList" parameterType="hashmap" resultType="com.example.test1.model.Product">
		
		SELECT FOOD_NAME,PRICE,FOOD_INFO,FILEPATH FROM TBL_FOOD F
		INNER JOIN TBL_FOOD_IMG I ON I.FOOD_NO=F.FOOD_NO
		WHERE 1=1
		
		<if test="keyWord!=null and keyWord!=''">
		 	AND (
				FOOD_NAME LIKE '%'||#{keyWord}||'%' OR FOOD_INFO LIKE '%'||#{keyWord}||'%'
				)
		</if>
		<if test="menuPart!=null and menuPart!=''">
		 	AND F.PART_NO=#{menuPart}
		</if>
		<if test="menuNo!=null and menuNo!=''">
		 	AND F.MENU_NO=#{menuNo}
		</if>
		
	
	</select>
	
	<select id="selectMenuList" parameterType="hashmap" resultType="com.example.test1.model.Menu">
		SELECT M.*, NVL(CNT,0) AS CNT
		FROM TBL_MENU M 
		LEFT JOIN(
		 SELECT MENU_PART, COUNT(MENU_PART) AS CNT
		 FROM TBL_MENU
		 GROUP BY MENU_PART
		)T ON M.MENU_NO=T.MENU_PART
	</select>
	
	<insert id="insertFood" parameterType="hashmap">
	 	INSERT INTO TBL_FOOD VALUES(#)
	</insert>

	
	<insert id="insertFoodImg" parameterType="hashmap">
		INSERT INTO TBL_FOOD_FILE VALUES (FOODFILE_SEQ.NEXTVAL, #{foodNo}, #{filePath},#{fileName},#{fileOrgName},#{fileSize},#{filEtc},#{thumbNailYn})
	</insert>
	
</mapper>




